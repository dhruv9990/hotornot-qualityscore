<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hot or Not</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
    <h1>Hot or Not</h1>
    <h2>Which tweet is of higher quality?</h2>
    <div class="tweet-container">
        <div class="tweet" data-winner="{{ tweet1.id }}" data-loser="{{ tweet2.id }}">
            <p>{{ tweet1.text }}</p>
        </div>
        <div class="tie-button-container">
            <button class="tie-button" data-tweet1="{{ tweet1.id }}" data-tweet2="{{ tweet2.id }}">Same Quality</button>
        </div>
        <div class="tweet" data-winner="{{ tweet2.id }}" data-loser="{{ tweet1.id }}">
            <p>{{ tweet2.text }}</p>
        </div>
    </div>

    <form id="vote-form" action="/vote" method="post" style="display: none;">
        <input type="hidden" id="winner" name="winner">
        <input type="hidden" id="loser" name="loser">
    </form>

    <form id="tie-form" action="/tie" method="post" style="display: none;">
        <input type="hidden" id="tie_tweet1" name="tweet1">
        <input type="hidden" id="tie_tweet2" name="tweet2">
    </form>

    <script>
        const tweetContainer = document.querySelector('.tweet-container');
        const voteForm = document.getElementById('vote-form');
        const winnerInput = document.getElementById('winner');
        const loserInput = document.getElementById('loser');
        const tieButton = document.querySelector('.tie-button');
        const tieForm = document.getElementById('tie-form');
        const tieTweet1Input = document.getElementById('tie_tweet1');
        const tieTweet2Input = document.getElementById('tie_tweet2');

        document.querySelectorAll('.tweet').forEach(item => {
            item.addEventListener('click', event => {
                // Prevent multiple clicks
                if (tweetContainer.classList.contains('disabled')) {
                    return;
                }
                
                // Disable the container and button
                tweetContainer.classList.add('disabled');
                tieButton.disabled = true;

                const winner = item.dataset.winner;
                const loser = item.dataset.loser;
                winnerInput.value = winner;
                loserInput.value = loser;
                voteForm.submit();
            });
        });

        tieButton.addEventListener('click', () => {
            // Prevent multiple clicks
            if (tweetContainer.classList.contains('disabled')) {
                return;
            }
            
            // Disable the container and button
            tweetContainer.classList.add('disabled');
            tieButton.disabled = true;

            const tweet1 = tieButton.dataset.tweet1;
            const tweet2 = tieButton.dataset.tweet2;
            tieTweet1Input.value = tweet1;
            tieTweet2Input.value = tweet2;
            tieForm.submit();
        });
    </script>
</body>
</html>
